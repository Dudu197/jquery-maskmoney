/*

jQuery Mask Money Plugin
Original: https://github.com/plentz/jquery-maskmoney
Fork: https://github.com/Dudu197/jquery-maskmoney

MoneyMask functions works only for Brazilian style (thousands: '.' and decimal: ',')

*/
var MoneyMask={encode:function(e){settings={prefix:"",suffix:"",affixesStay:!0,thousands:".",decimal:",",precision:2,allowZero:!1,allowNegative:!1};var t,n,a,r=e.indexOf("-")>-1&&settings.allowNegative?"-":"",i=e.replace(/[^0-9]/g,""),o=i.slice(0,i.length-settings.precision);return o=o.replace(/^0*/g,""),o=o.replace(/\B(?=(\d{3})+(?!\d))/g,settings.thousands),""===o&&(o="0"),t=r+o,settings.precision>0&&(n=i.slice(i.length-settings.precision),a=new Array(settings.precision+1-n.length).join(0),t+=settings.decimal+a+n),t},decode:function(e){return Number(e.replace(/\./g,"").replace(",",".")).toFixed(2)}};!function(e){"use strict";e.browser||(e.browser={},e.browser.mozilla=/mozilla/.test(navigator.userAgent.toLowerCase())&&!/webkit/.test(navigator.userAgent.toLowerCase()),e.browser.webkit=/webkit/.test(navigator.userAgent.toLowerCase()),e.browser.opera=/opera/.test(navigator.userAgent.toLowerCase()),e.browser.msie=/msie/.test(navigator.userAgent.toLowerCase()));var t={destroy:function(){return e(this).unbind(".maskMoney"),e.browser.msie&&(this.onpaste=null),this},mask:function(t){return this.each(function(){var n=e(this);return"number"==typeof t&&n.val(t),n.trigger("mask")})},getPrecision:function(e,t){var n=0;if("auto"==t.precision||"custom"==t.precision){if("auto"==t.precision&&void 0!=e.attr("precision"))return parseInt(e.attr("precision"));var a=e.val(),r=a.split(t.decimal);2==r.length&&(n=r[1].length),e.attr("precision",n)}else n=t.precision;return n},unmasked:function(){return this.map(function(){var t,n=e(this).val()||"0",a=-1!==n.indexOf("-");return e(n.split(/\D/).reverse()).each(function(e,n){return n?(t=n,!1):void 0}),n=n.replace(/\D/g,""),n=n.replace(new RegExp(t+"$"),"."+t),a&&(n="-"+n),parseFloat(n)})},init:function(n){return n=e.extend({prefix:"",suffix:"",affixesStay:!0,thousands:",",decimal:".",precision:"auto",allowZero:!1,allowNegative:!1},n),this.each(function(){function a(){var e,t,n,a,r,i=x.get(0),o=0,s=0;return"number"==typeof i.selectionStart&&"number"==typeof i.selectionEnd?(o=i.selectionStart,s=i.selectionEnd):(t=document.selection.createRange(),t&&t.parentElement()===i&&(a=i.value.length,e=i.value.replace(/\r\n/g,"\n"),n=i.createTextRange(),n.moveToBookmark(t.getBookmark()),r=i.createTextRange(),r.collapse(!1),n.compareEndPoints("StartToEnd",r)>-1?o=s=a:(o=-n.moveStart("character",-a),o+=e.slice(0,o).split("\n").length-1,n.compareEndPoints("EndToEnd",r)>-1?s=a:(s=-n.moveEnd("character",-a),s+=e.slice(0,s).split("\n").length-1)))),{start:o,end:s}}function r(){var e=!(x.val().length>=x.attr("maxlength")&&x.attr("maxlength")>=0),t=a(),n=t.start,r=t.end,i=t.start!==t.end&&x.val().substring(n,r).match(/\d/)?!0:!1,o="0"===x.val().substring(0,1);return e||i||o}function i(e){x.each(function(t,n){if(n.setSelectionRange)n.focus(),n.setSelectionRange(e,e);else if(n.createTextRange){var a=n.createTextRange();a.collapse(!0),a.moveEnd("character",e),a.moveStart("character",e),a.select()}})}function o(e){var t="";return e.indexOf("-")>-1&&(e=e.replace("-",""),t="-"),t+y.prefix+e+y.suffix}function s(e){var n,a,r,i=e.indexOf("-")>-1&&y.allowNegative?"-":"",s=e.replace(/[^0-9]/g,""),l=t.getPrecision(x,y),c=s.slice(0,s.length-l);return c=c.replace(/^0*/g,""),c=c.replace(/\B(?=(\d{3})+(?!\d))/g,y.thousands),""===c&&(c="0"),n=i+c,l>0&&(a=s.slice(s.length-l),r=new Array(l+1-a.length).join(0),n+=y.decimal+r+a),o(n)}function l(e){var t,n=x.val().length;x.val(s(x.val())),t=x.val().length,e-=n-t,i(e)}function c(){var e=x.val(),n=t.getPrecision(x,y);n>0&&e.indexOf(y.decimal)<0&&(e+=y.decimal+new Array(n+1).join(0)),x.val(s(e))}function u(){var e=x.val();return y.allowNegative?""!==e&&"-"===e.charAt(0)?e.replace("-",""):"-"+e:e}function g(e){e.preventDefault?e.preventDefault():e.returnValue=!1}function v(t){t=t||window.event;var n,i,o,s,c,v=t.which||t.charCode||t.keyCode;return void 0===v?!1:(48>v||v>57)&&"custom"!==y.precision?45===v?(x.val(u()),!1):43===v?(x.val(x.val().replace("-","")),!1):13===v||9===v?!0:!e.browser.mozilla||37!==v&&39!==v||0!==t.charCode?(g(t),!0):!0:r()?(g(t),n=String.fromCharCode(v),i=a(),o=i.start,s=i.end,c=x.val(),x.val(c.substring(0,o)+n+c.substring(s,c.length)),l(o+1),!1):!1}function d(e){e=e||window.event;var t,n,r,i,o,s=e.which||e.charCode||e.keyCode;return void 0===s?!1:(t=a(),n=t.start,r=t.end,8===s||46===s||63272===s?(g(e),i=x.val(),n===r&&(8===s?""===y.suffix?n-=1:(o=i.split("").reverse().join("").search(/\d/),n=i.length-o-1,r=n+1):r+=1),x.val(i.substring(0,n)+i.substring(r,i.length)),l(n),!1):9===s?!0:!0)}function f(){b=x.val(),c();var e,t=x.get(0);"custom"!==y.precision&&t.createTextRange&&(e=t.createTextRange(),e.collapse(!1),e.select())}function p(){setTimeout(function(){c()},0)}function m(){var e=t.getPrecision(x,y),n=parseFloat("0")/Math.pow(10,e);return n.toFixed(e).replace(new RegExp("\\.","g"),y.decimal)}function h(t){if(e.browser.msie&&v(t),""===x.val()||x.val()===o(m()))y.allowZero?y.affixesStay?x.val(o(m())):x.val(m()):x.val("");else if(!y.affixesStay){var n=x.val().replace(y.prefix,"").replace(y.suffix,"");x.val(n)}x.val()!==b&&x.change()}function w(){var e,t=x.get(0);"custom"!==y.precision&&t.setSelectionRange?(e=x.val().length,t.setSelectionRange(e,e)):x.val(x.val())}var y,b,x=e(this);y=e.extend({},n),y=e.extend(y,x.data()),x.unbind(".maskMoney"),x.bind("keypress.maskMoney",v),x.bind("keydown.maskMoney",d),x.bind("blur.maskMoney",h),x.bind("focus.maskMoney",f),x.bind("click.maskMoney",w),x.bind("cut.maskMoney",p),x.bind("paste.maskMoney",p),x.bind("mask.maskMoney",c)})}};e.fn.maskMoney=function(n){return t[n]?t[n].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof n&&n?void e.error("Method "+n+" does not exist on jQuery.maskMoney"):t.init.apply(this,arguments)}}(window.jQuery||window.Zepto);